package com.prueba.api.controllers;

import java.util.List;
import java.util.Optional;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.web.bind.annotation.DeleteMapping;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.PathVariable;
import org.springframework.web.bind.annotation.PostMapping;
import org.springframework.web.bind.annotation.RequestBody;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RestController;
import com.prueba.api.models.Album;
import com.prueba.api.services.AlbumService;
import lombok.extern.slf4j.Slf4j;

@Slf4j
@RestController
@RequestMapping("/album")
public class AlbumController   {
  
  AlbumService albumService;

  @Autowired
  public AlbumController(AlbumService albumService) {
    this.albumService = albumService;
  }

   @GetMapping("/saveIntoDB")
   public String saveIntoDB(){
    log.info("/saveIntoDB");
    return "Se han guardado los albums dela API ";
   }

   @GetMapping("/getFromDB")
   public String getFromDB(){
    log.info("/getFromDB");
    return "xxxx ";
   }

   @GetMapping(path ="/getFromAPI")
   public String getFromAPI(){
    log.info("/getFromAPI");
    return "xxxx ";
   }

  @GetMapping()
   public List<Album> getAllAlbums(){
    return this.albumService.obtenerAlbums();
   }
    
   @PostMapping()
   public Album deleteAlbum(@RequestBody Album usuario){
    return this.albumService.saveAlbum(usuario);
   }

   //Ejemlo http://localhost:8080/album/1
   @GetMapping(path ="/{id}")
   public Optional<Album> getAlbumById(@PathVariable("id") Long id){
    log.info("Buscar Album por id");
    return this.albumService.getAlbumById(id);
   }

  @DeleteMapping(path ="/{id}")
  public String deleteById(@PathVariable("id") Long id){
    boolean ok = this.albumService.deleteAlbum(id);
    if(ok){
      return "Deleted album "+id;
    }else{
      return "The album could not be deleted "+id;
    }

  }





}
